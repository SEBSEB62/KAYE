import{R as N,j as e,r as x,P as y,x as R,W as C,y as b}from"./Icons-C56Ecv4l.js";import{u as P,P as g}from"./main-CCzraqPD.js";import{u as A}from"./useEventAnalytics-CvWWVUE_.js";import{f as m,a as F}from"./formatting-B5pXF3od.js";function S(t,s){const n=new Date;n.setHours(0,0,0,0);const l=(t||[]).filter(a=>new Date(a.date)>=n&&!a.refunded),o=l.reduce((a,c)=>a+(c.total||0),0);let i=null;if(l.length>0){const a=l.flatMap(r=>r.items||[]).reduce((r,d)=>(r[d.id]=(r[d.id]||0)+(d.quantity||0),r),{}),c=Object.keys(a).reduce((r,d)=>a[r]>a[d]?r:d,""),u=(s||[]).find(r=>r.id===c);u&&(i={...u,unitsSold:a[c]})}return{revenue:o,salesCount:l.length,topProduct:i}}function E(t,s){return(t||0)*((s||0)/100)}function $(t){return t==="elegant"?"font-display":t==="handwritten"?"font-handwritten":"font-sans"}function I(t){return{estimatedFees:t?.estimatedFees??0,netRevenueAfterFees:t?.netRevenueAfterFees??0,totalRevenue:t?.totalRevenue??0}}function M(t,s){const n=t.netRevenueAfterFees,l=t.estimatedFees,o=s??0,i=E(t.totalRevenue,o);return{netEstimated:n,feesEstimated:l,urssafRate:o,urssafCharge:i}}const T=()=>e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"text-3xl",children:"Chargement‚Ä¶"})})}),f=({icon:t,title:s,value:n,color:l,subValue:o})=>e.jsxs("div",{className:"glass-panel p-4 rounded-2xl flex items-start space-x-4 transition-all hover:scale-[1.02]",children:[e.jsx("div",{className:`p-3 rounded-full bg-black/5 dark:bg-black/40 border border-black/5 dark:border-white/10 ${l}`,children:e.jsx(t,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-300 font-medium",children:s}),e.jsx("p",{className:"text-2xl font-bold font-sans text-slate-900 dark:text-white drop-shadow-sm",children:n}),o&&e.jsx("div",{className:"mt-1 text-xs text-slate-500 dark:text-slate-400",children:o})]})]}),H=({product:t})=>e.jsxs("div",{className:"glass-panel p-4 rounded-2xl flex items-center space-x-4 col-span-2 transition-all hover:scale-[1.02]",children:[e.jsx("div",{className:"w-16 h-16 rounded-xl overflow-hidden bg-white/50 dark:bg-black/30 flex items-center justify-center flex-shrink-0 border border-black/5 dark:border-white/10 shadow-inner",children:t?e.jsx(g,{image:t.image,alt:t.name,className:"w-full h-full object-contain text-3xl"}):e.jsx("span",{className:"text-3xl",children:"üèÜ"})}),e.jsxs("div",{className:"overflow-hidden",children:[e.jsx("p",{className:"text-xs uppercase tracking-wider text-slate-500 dark:text-slate-400 font-bold mb-1",children:"Produit Phare du Jour"}),t?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-xl font-bold text-slate-900 dark:text-white truncate drop-shadow-sm",children:t.name}),e.jsxs("p",{className:"text-sm text-blue-600 dark:text-blue-400 font-semibold",children:[t.unitsSold," vendu",t.unitsSold>1?"s":""]})]}):e.jsx("p",{className:"text-lg font-bold text-slate-500",children:"Aucune vente"})]})]}),L=({setPage:t})=>{const{settings:s,sales:n,donations:l,manualRefunds:o,safeDeposits:i,products:a,cashOuts:c,labels:u}=P(),r=A(n,l,o,i,c,a,s,null);if(!n||!a||!s||!u||!r||!Array.isArray(n))return e.jsx(T,{});const d=x.useMemo(()=>I(r),[r]),h=x.useMemo(()=>S(n,a),[n,a]),p=x.useMemo(()=>$(s.appFont),[s.appFont]),{netEstimated:j,feesEstimated:v,urssafRate:k,urssafCharge:w}=x.useMemo(()=>M(d,s.urssafRate),[d,s.urssafRate]);return e.jsxs("div",{className:"flex flex-col h-full space-y-6 justify-center max-w-xl mx-auto w-full",children:[e.jsxs("div",{className:"text-center animate-in fade-in-0 slide-in-from-top-5 duration-700",children:[s.businessLogo?e.jsx("div",{className:"w-32 h-32 mx-auto mb-4 rounded-full overflow-hidden shadow-2xl border-4 border-white/20 dark:border-white/10 bg-white/20 dark:bg-black/20 flex items-center justify-center backdrop-blur-sm",children:e.jsx(g,{image:s.businessLogo,alt:"Logo",className:"w-full h-full object-contain"})}):null,e.jsx("h1",{className:`text-4xl md:text-5xl text-slate-900 dark:text-white drop-shadow-lg ${p}`,children:s.businessName||u.buvette}),e.jsx("p",{className:"text-slate-600 dark:text-slate-300 mt-1 font-light tracking-wide",children:"Tableau de bord"})]}),e.jsx("div",{className:"animate-in fade-in-0 slide-in-from-bottom-5 duration-500 delay-100 px-4",children:e.jsx("button",{onClick:()=>t(y.Sale),className:`w-full bg-orange-500 text-black font-bold py-4 px-8 rounded-2xl shadow-lg shadow-orange-500/20 text-xl font-display
                       hover:shadow-orange-500/40 hover:bg-orange-400 transform hover:scale-[1.02] transition-all duration-300 border border-orange-400/50 backdrop-blur-sm`,children:"Effectuer une Vente"})}),e.jsxs("div",{className:"animate-in fade-in-0 slide-in-from-bottom-5 duration-500 delay-200 px-2",children:[e.jsx("h2",{className:`text-lg text-slate-700 dark:text-slate-300 mb-3 px-2 opacity-90 ${p}`,children:"Aper√ßu rapide"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(f,{icon:R,title:"C.A. du Jour",value:`${m(h.revenue)}`,color:"text-emerald-600 dark:text-emerald-400"}),e.jsx(f,{icon:C,title:"Net Estim√©",value:`${m(j)}`,subValue:e.jsxs("span",{className:"text-slate-500 dark:text-slate-400/80",children:["Dont frais: -",m(v)]}),color:"text-blue-600 dark:text-blue-400"}),e.jsx(f,{icon:b,title:"Charges √† pr√©voir (URSSAF)",value:`${m(w)}`,subValue:e.jsxs("span",{className:"text-slate-500 dark:text-slate-400/80",children:["Taux: ",F(k)]}),color:"text-orange-600 dark:text-orange-400"}),e.jsx(f,{icon:b,title:"Ventes du Jour",value:h.salesCount,color:"text-sky-600 dark:text-sky-400"}),e.jsx(H,{product:h.topProduct})]})]})]})},O=N.memo(L);export{O as default};
