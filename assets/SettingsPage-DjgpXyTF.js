import{r as d,S as z,j as e,i as H,y as O,O as W,A as X,T as _,X as J,$ as K,a0 as Q,W as Y,a1 as Z,a2 as ee,L as $,P as se}from"./Icons-C56Ecv4l.js";import{u as ae,c as te}from"./main-B5JQxShm.js";import{P as le}from"./PremiumLockModal-DvvXgwtw.js";const b=({onClick:j})=>e.jsx("div",{onClick:j,className:"absolute inset-0 bg-black/60 backdrop-blur-[2px] flex items-center justify-center rounded-xl cursor-pointer group z-10",children:e.jsxs("span",{className:"text-orange-400 font-bold flex items-center gap-2 transition-transform duration-200 group-hover:scale-110",children:[e.jsx($,{className:"w-5 h-5"})," Débloquer avec un plan supérieur"]})}),re=({setPage:j})=>{const{settings:u,setSettings:F,showToast:x,subscriptionPlan:y,currentUser:q,logoutUser:B,changeAdminPassword:T}=ae(),[t,l]=d.useState(u),[h,C]=d.useState(""),[M,S]=d.useState(""),[P,m]=d.useState({isOpen:!1,featureName:""}),[p,I]=d.useState(""),A=d.useRef(null),R=d.useRef(null),L=d.useRef(null),i=y===z.STANDARD||y===z.PRO;d.useEffect(()=>{l(u)},[u]);const D=()=>{if(h&&h!==M){x("Les nouveaux mots de passe admin ne correspondent pas.","error");return}F(t);try{t.hourlyRate!==void 0&&t.hourlyRate!==null&&localStorage.setItem("buvette-hourlyRate",String(t.hourlyRate))}catch{}h&&(T(h),x("Mot de passe admin mis à jour.","success")),C(""),S(""),x("Paramètres enregistrés avec succès !","success")},v=async(s,a)=>{if(!i){m({isOpen:!0,featureName:a==="businessLogo"?"Logo personnalisé":"Média de démarrage"});return}if(s.target.files&&s.target.files[0]){const f=s.target.files[0];try{const w=await te(f,a==="backgroundImage"?{maxWidth:1920,maxHeight:1080,quality:.8}:a==="businessLogo"?{maxWidth:300,maxHeight:300}:{quality:.8});l(U=>({...U,[a]:w})),x(`${a==="businessLogo"?"Logo":a==="backgroundImage"?"Fond d'écran":"Média de démarrage"} mis à jour.`)}catch(k){const w=k instanceof Error?k.message:"Erreur lors du traitement du fichier.";x(w,"error")}}},N=s=>{i&&(l(a=>({...a,[s]:null})),x(`${s==="businessLogo"?"Logo":s==="backgroundImage"?"Fond d'écran":"Média de démarrage"} supprimé.`))},E=()=>{m({isOpen:!1,featureName:""}),j(se.Upgrade)},G=()=>{p.trim()&&!t.categories.includes(p.trim())&&(l(s=>({...s,categories:[...s.categories,p.trim()]})),I(""))},V=s=>{if(t.categories.length<=1){x("Il faut conserver au moins une catégorie.","error");return}l(a=>({...a,categories:a.categories.filter(f=>f!==s)}))},o="glass-panel p-6 rounded-2xl shadow-xl space-y-4 animate-in fade-in-0 slide-in-from-bottom-3",n="mt-1 block w-full p-3 bg-white/20 dark:bg-black/40 border border-slate-300 dark:border-white/20 text-slate-900 dark:text-white rounded-xl shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition placeholder-slate-500",g="disabled:opacity-50 disabled:cursor-not-allowed",r="block text-sm font-medium text-slate-700 dark:text-slate-300",c="text-2xl font-display text-slate-800 dark:text-slate-200 flex items-center gap-2";return e.jsxs("div",{className:"space-y-8 max-w-2xl mx-auto pb-10",children:[e.jsx("h1",{className:"text-4xl font-display text-center text-blue-500 dark:text-blue-400 drop-shadow-md",children:"Paramètres"}),e.jsxs("div",{className:o,children:[e.jsxs("h2",{className:c,children:[e.jsx(H,{className:"w-6 h-6"}),"Compte"]}),e.jsxs("div",{className:"bg-white/30 dark:bg-black/30 p-4 rounded-lg border border-slate-300 dark:border-white/10",children:[e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Connecté en tant que :"}),e.jsx("p",{className:"text-lg font-semibold text-slate-900 dark:text-white truncate",children:q?.email})]}),e.jsx("button",{onClick:B,className:"w-full bg-slate-200 dark:bg-slate-600/80 text-slate-800 dark:text-slate-200 font-bold py-3 px-6 rounded-full shadow-lg hover:bg-slate-300 dark:hover:bg-slate-700 transition-colors font-display text-lg",children:"Déconnexion"})]}),e.jsxs("div",{className:o,children:[e.jsxs("h2",{className:c,children:[e.jsx(O,{className:"w-6 h-6 text-amber-400"})," Rentabilité Créateur"]}),e.jsx("p",{className:"text-slate-600 dark:text-slate-300 text-sm",children:"Définissez votre taux horaire cible pour inclure la main d'œuvre dans le coût de revient."}),e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{className:r,children:"Mon taux horaire cible (€ / heure)"}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:t.hourlyRate??0,onChange:s=>l(a=>({...a,hourlyRate:parseFloat(s.target.value||"0")})),className:n}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:"Cette valeur sera utilisée pour estimer le coût main d'œuvre par produit. Sauvegardez pour persister."})]})]}),e.jsxs("div",{className:o,children:[e.jsxs("h2",{className:c,children:[e.jsx(W,{className:"w-6 h-6"})," Mode d'Application"]}),e.jsx("p",{className:"text-slate-600 dark:text-slate-300 text-sm",children:"Adaptez le vocabulaire à votre activité."}),e.jsxs("div",{children:[e.jsx("label",{className:r,children:"Type d'activité"}),e.jsxs("select",{value:t.appMode,onChange:s=>l(a=>({...a,appMode:s.target.value})),className:n,children:[e.jsx("option",{value:"business",children:"Commerce / VDI (Vente à domicile, Boutique)"}),e.jsx("option",{value:"association",children:"Association / Buvette (Dons, Bénévoles)"})]})]})]}),e.jsxs("div",{className:o,children:[e.jsxs("h2",{className:c,children:[e.jsx(X,{className:"w-6 h-6"})," Préférences de Stock"]}),e.jsxs("div",{children:[e.jsx("label",{className:r,children:`Seuil d'alerte "Stock Bas"`}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mb-2",children:"Les produits ayant une quantité inférieure ou égale à ce nombre seront marqués en orange (alerte)."}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"number",min:"0",max:"1000",value:t.lowStockThreshold,onChange:s=>l(a=>({...a,lowStockThreshold:parseInt(s.target.value)||0})),className:`${n} max-w-[120px] text-center !mt-0 font-bold text-xl`}),e.jsx("span",{className:"text-slate-600 dark:text-slate-300 font-bold",children:"unités"})]})]})]}),e.jsxs("div",{className:o,children:[e.jsxs("h2",{className:c,children:[e.jsx(_,{className:"w-6 h-6"})," Gérer mes Rayons/Catégories"]}),e.jsx("p",{className:"text-slate-600 dark:text-slate-300 text-sm",children:"Ajoutez ou supprimez des catégories pour vos produits."}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:p,onChange:s=>I(s.target.value),placeholder:"Nouvelle catégorie (ex: Bijoux)",className:"flex-grow p-3 bg-white/20 dark:bg-black/40 border border-slate-300 dark:border-white/20 text-slate-900 dark:text-white rounded-xl focus:ring-2 focus:ring-blue-500"}),e.jsx("button",{onClick:G,className:"bg-blue-600 hover:bg-blue-500 text-white px-4 rounded-xl font-bold",children:"Ajouter"})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-4",children:t.categories.map(s=>e.jsxs("div",{className:"flex items-center gap-2 bg-white/40 dark:bg-slate-700/50 px-3 py-2 rounded-lg border border-slate-300 dark:border-white/10",children:[e.jsx("span",{className:"text-slate-800 dark:text-slate-200",children:s}),e.jsx("button",{onClick:()=>V(s),className:"text-slate-500 hover:text-red-500 dark:text-slate-400 dark:hover:text-red-400 transition-colors",title:"Supprimer",children:e.jsx(J,{className:"w-5 h-5"})})]},s))})]}),e.jsxs("div",{className:o,children:[e.jsxs("h2",{className:c,children:[e.jsx(K,{className:"w-6 h-6 text-orange-400"})," Mon Image de Marque"]}),e.jsx("p",{className:"text-slate-600 dark:text-slate-300 text-sm",children:"Personnalisez l'application pour qu'elle reflète votre identité."}),e.jsxs("div",{children:[e.jsx("label",{className:r,children:"Nom de la boutique / Buvette"}),e.jsx("input",{type:"text",value:t.businessName,onChange:s=>l(a=>({...a,businessName:s.target.value})),placeholder:"ex: Gaïa Création",className:n})]}),e.jsxs("div",{children:[e.jsx("label",{className:r,children:"Couleur principale (Thème)"}),e.jsxs("div",{className:"flex gap-4 mt-2 items-center",children:[e.jsx("div",{className:"relative overflow-hidden w-full h-12 rounded-xl border border-slate-300 dark:border-white/20",children:e.jsx("input",{type:"color",value:t.brandColor||"#2563eb",onChange:s=>l(a=>({...a,brandColor:s.target.value})),className:"absolute -top-2 -left-2 w-[120%] h-[150%] cursor-pointer p-0 border-0"})}),e.jsx("span",{className:"self-center text-slate-500 dark:text-slate-400 text-sm font-mono",children:t.brandColor||"#2563eb"})]})]}),e.jsxs("div",{className:"pt-2 border-t border-slate-300 dark:border-white/10",children:[e.jsxs("h3",{className:"text-lg font-semibold text-slate-800 dark:text-slate-200 mb-2 flex items-center gap-2",children:[e.jsx(Q,{className:"w-5 h-5"})," Apparence"]}),e.jsxs("div",{className:"mb-6 flex items-center justify-between bg-white/20 dark:bg-black/20 p-3 rounded-xl border border-slate-300 dark:border-white/10",children:[e.jsxs("div",{children:[e.jsx("span",{className:"block font-medium text-slate-800 dark:text-slate-200",children:"Thème de l'interface"}),e.jsx("span",{className:"text-xs text-slate-500 dark:text-slate-400",children:t.themeMode==="dark"?"Mode Sombre (Actif)":"Mode Clair (Actif)"})]}),e.jsx("button",{onClick:()=>l(s=>({...s,themeMode:s.themeMode==="dark"?"light":"dark"})),className:`relative inline-flex h-8 w-14 items-center rounded-full transition-colors duration-300 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 ${t.themeMode==="dark"?"bg-slate-700":"bg-yellow-400"}`,children:e.jsx("span",{className:`${t.themeMode==="dark"?"translate-x-7 bg-slate-300":"translate-x-1 bg-white"} inline-block h-6 w-6 transform rounded-full transition-transform duration-300 shadow-md flex items-center justify-center`,children:t.themeMode==="dark"?e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"w-4 h-4 text-slate-800",children:e.jsx("path",{fillRule:"evenodd",d:"M9.528 1.718a.75.75 0 01.162.819A8.97 8.97 0 009 6a9 9 0 009 9 8.97 8.97 0 003.463-.69.75.75 0 01.981.98 10.503 10.503 0 01-9.694 6.46c-5.799 0-10.5-4.701-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 01.818.162z",clipRule:"evenodd"})}):e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"w-4 h-4 text-yellow-600",children:e.jsx("path",{d:"M12 2.25a.75.75 0 01.75.75v2.25a.75.75 0 01-1.5 0V3a.75.75 0 01.75-.75zM7.5 12a4.5 4.5 0 119 0 4.5 4.5 0 01-9 0zM18.894 6.166a.75.75 0 00-1.06-1.06l-1.591 1.59a.75.75 0 101.06 1.061l1.591-1.59zM21.75 12a.75.75 0 01-.75.75h-2.25a.75.75 0 010-1.5H21a.75.75 0 01.75.75zM17.834 18.894a.75.75 0 001.06-1.06l-1.59-1.591a.75.75 0 10-1.061 1.06l1.59 1.591zM12 18a.75.75 0 01.75.75V21a.75.75 0 01-1.5 0v-2.25A.75.75 0 0112 18zM7.758 17.303a.75.75 0 00-1.061-1.06l-1.591 1.59a.75.75 0 001.06 1.061l1.591-1.59zM6 12a.75.75 0 01-.75.75H3a.75.75 0 010-1.5h2.25A.75.75 0 016 12zM6.697 7.757a.75.75 0 001.06-1.06l-1.59-1.591a.75.75 0 00-1.061 1.06l1.59 1.591z"})})})})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:`${r} mb-1`,children:"Image de fond d'écran"}),e.jsxs("div",{className:"flex items-center gap-4 relative",children:[e.jsx("button",{type:"button",onClick:()=>L.current?.click(),className:`${n} !mt-0 text-left flex-grow ${g}`,disabled:!i,children:t.backgroundImage?"Changer l'image...":"Choisir une image..."}),t.backgroundImage&&i&&e.jsx("button",{type:"button",onClick:()=>N("backgroundImage"),className:"text-sm text-red-500 hover:text-red-400 dark:text-red-400 dark:hover:text-red-300 p-2 flex-shrink-0",children:"Supprimer"}),!i&&e.jsx(b,{onClick:()=>m({isOpen:!0,featureName:"Fond d'écran personnalisé"})})]}),e.jsx("input",{type:"file",ref:L,onChange:s=>v(s,"backgroundImage"),accept:"image/*",className:"hidden"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsxs("label",{className:r,children:["Opacité du voile ",t.themeMode==="dark"?"noir":"blanc"]}),e.jsxs("span",{className:"text-sm text-slate-500 dark:text-slate-400",children:[Math.round((t.backgroundOverlayOpacity||.7)*100),"%"]})]}),e.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:t.backgroundOverlayOpacity??.7,onChange:s=>l(a=>({...a,backgroundOverlayOpacity:parseFloat(s.target.value)})),className:"w-full h-2 bg-slate-300 dark:bg-slate-700 rounded-lg appearance-none cursor-pointer accent-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:`${r} mb-2`,children:"Police d'écriture"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:["modern","elegant","handwritten"].map(s=>e.jsx("button",{onClick:()=>l(a=>({...a,appFont:s})),className:`py-2 px-1 text-sm rounded-lg border transition-all ${t.appFont===s?"bg-blue-600 border-blue-400 text-white shadow-lg scale-105":"bg-white/20 dark:bg-black/40 border-slate-300 dark:border-white/10 text-slate-600 dark:text-slate-400 hover:bg-white/40 dark:hover:bg-white/10"}`,children:e.jsx("span",{className:s==="elegant"?"font-display":s==="handwritten"?"font-handwritten text-lg":"font-sans",children:s==="modern"?"Moderne":s==="elegant"?"Élégant":"Manuscrit"})},s))})]})]})]}),e.jsxs("div",{className:o,children:[e.jsxs("h2",{className:c,children:[e.jsx(Y,{className:"w-6 h-6"})," Abonnement"]}),e.jsxs("div",{className:"bg-white/30 dark:bg-black/30 p-4 rounded-lg text-center border border-slate-300 dark:border-white/10",children:[e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Votre Plan Actuel"}),e.jsx("p",{className:"text-2xl font-bold text-orange-500 dark:text-orange-400",children:u.subscriptionPlan}),u.subscriptionExpiry&&e.jsxs("p",{className:"text-sm text-slate-600 dark:text-slate-300 mt-1",children:["Expire le: ",new Date(u.subscriptionExpiry).toLocaleDateString("fr-FR")]})]})]}),e.jsxs("div",{className:o,children:[e.jsxs("h2",{className:c,children:[e.jsx(Z,{className:"w-6 h-6"})," Infos de l'Établissement"]}),e.jsxs("div",{children:[e.jsx("label",{className:r,children:"Adresse"}),e.jsx("input",{type:"text",value:t.businessAddress,onChange:s=>l(a=>({...a,businessAddress:s.target.value})),placeholder:"ex: 123 Rue de l'Événement, 75000 Paris",className:n})]}),e.jsxs("div",{children:[e.jsx("label",{className:r,children:"Contact"}),e.jsx("input",{type:"text",value:t.businessContact,onChange:s=>l(a=>({...a,businessContact:s.target.value})),placeholder:"ex: contact@kaye.com / 01 23 45 67 89",className:n})]}),e.jsxs("div",{className:"relative",children:[e.jsx("label",{className:r,children:"Pied de page du ticket"}),e.jsx("textarea",{value:t.receiptFooter,onChange:s=>l(a=>({...a,receiptFooter:s.target.value})),className:`${n} ${g}`,disabled:!i,rows:3,placeholder:"ex: Merci de votre visite ! Suivez-nous sur les réseaux sociaux !"}),!i&&e.jsx(b,{onClick:()=>m({isOpen:!0,featureName:"Pied de page du ticket"})})]})]}),e.jsxs("div",{className:o,children:[e.jsxs("h2",{className:c,children:[e.jsx(O,{className:"w-6 h-6 text-orange-500"})," URSSAF (Estimation)"]}),e.jsx("p",{className:"text-slate-600 dark:text-slate-300 text-sm",children:"Estimez les cotisations sociales selon votre activité (micro-entrepreneur)."}),e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{className:r,children:"Type d'activité"}),e.jsxs("div",{className:"flex gap-3 mt-2",children:[e.jsxs("label",{className:"inline-flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:"urssafActivity",value:"vente",checked:t.urssafActivity==="vente",onChange:()=>l(s=>({...s,urssafActivity:"vente",urssafRate:12.3}))}),e.jsx("span",{className:"text-sm",children:"Vente de marchandises (VDI) — ~12.3%"})]}),e.jsxs("label",{className:"inline-flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:"urssafActivity",value:"prestation",checked:t.urssafActivity==="prestation",onChange:()=>l(s=>({...s,urssafActivity:"prestation",urssafRate:21.2}))}),e.jsx("span",{className:"text-sm",children:"Prestations de services — ~21.2%"})]})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("label",{className:r,children:"Taux personnalisé (%)"}),e.jsx("input",{type:"number",step:"0.1",min:"0",max:"100",value:t.urssafRate??0,onChange:s=>l(a=>({...a,urssafRate:parseFloat(s.target.value||"0")})),className:n}),e.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:["Le calcul affichera une estimation: ",e.jsx("strong",{children:"(CA total × taux) / 100"}),". Ne modifie pas automatiquement le bénéfice affiché."]})]})]})]}),e.jsxs("div",{className:o,children:[e.jsxs("h2",{className:c,children:[e.jsx(ee,{className:"w-6 h-6"})," Média"]}),e.jsxs("div",{className:"relative",children:[e.jsx("label",{className:r,children:"Logo pour les tickets"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{type:"button",onClick:()=>A.current?.click(),className:`${n} !mt-1 text-left flex-grow ${g}`,disabled:!i,children:t.businessLogo?"Changer le logo...":"Choisir un logo..."}),t.businessLogo&&i&&e.jsx("button",{type:"button",onClick:()=>N("businessLogo"),className:"text-sm text-red-500 hover:text-red-400 dark:text-red-400 dark:hover:text-red-300 p-2 flex-shrink-0",children:"Supprimer"})]}),e.jsx("input",{type:"file",ref:A,onChange:s=>v(s,"businessLogo"),accept:"image/jpeg,image/png",className:"hidden"}),!i&&e.jsx(b,{onClick:()=>m({isOpen:!0,featureName:"Logo personnalisé"})})]}),e.jsxs("div",{className:"relative",children:[e.jsx("label",{className:r,children:"GIF/Vidéo de démarrage"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{type:"button",onClick:()=>R.current?.click(),className:`${n} !mt-1 text-left flex-grow ${g}`,disabled:!i,children:t.startupGif?"Changer le média...":"Choisir un média..."}),t.startupGif&&i&&e.jsx("button",{type:"button",onClick:()=>N("startupGif"),className:"text-sm text-red-500 hover:text-red-400 dark:text-red-400 dark:hover:text-red-300 p-2 flex-shrink-0",children:"Supprimer"})]}),e.jsx("input",{type:"file",ref:R,onChange:s=>v(s,"startupGif"),accept:"image/gif,video/mp4,video/webm",className:"hidden"}),!i&&e.jsx(b,{onClick:()=>m({isOpen:!0,featureName:"Média de démarrage"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:r,children:"Mode d'affichage des produits"}),e.jsxs("select",{value:t.uiMode,onChange:s=>l(a=>({...a,uiMode:s.target.value})),className:n,children:[e.jsx("option",{value:"carousel",children:"Carrousel"}),e.jsx("option",{value:"grid",children:"Grille"})]})]})]}),e.jsxs("div",{className:o,children:[e.jsxs("h2",{className:c,children:[e.jsx($,{className:"w-6 h-6"})," Sécurité"]}),e.jsxs("div",{children:[e.jsx("label",{className:r,children:"Nouveau mot de passe admin"}),e.jsx("input",{type:"password",value:h,onChange:s=>C(s.target.value),className:n,placeholder:"Laisser vide pour ne pas changer"})]}),e.jsxs("div",{children:[e.jsx("label",{className:r,children:"Confirmer le mot de passe"}),e.jsx("input",{type:"password",value:M,onChange:s=>S(s.target.value),className:n})]}),e.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400 !mt-2",children:["Ceci modifie le mot de passe pour l'accès administrateur local. Pour changer les codes PIN de l'équipe, allez dans ",e.jsx("strong",{children:"Plus > Équipe"}),"."]})]}),e.jsx("div",{className:"flex justify-end sticky bottom-20 z-20",children:e.jsx("button",{onClick:D,className:"bg-orange-500 text-black font-bold py-3 px-6 rounded-full shadow-lg hover:bg-orange-600 transition-all transform hover:scale-105 font-display text-lg",children:"Enregistrer les Modifications"})}),e.jsx(le,{isOpen:P.isOpen,onClose:()=>m({isOpen:!1,featureName:""}),onUpgrade:E,featureName:P.featureName})]})},ce=d.memo(re);export{ce as default};
