import{r,j as e,$ as w}from"./Icons-C56Ecv4l.js";import{G as A,T as c}from"./index-dXEpzMxB.js";import{u as E}from"./main-sP1ObtPy.js";var y={};const l=!!y.VITE_GEMINI_API_KEY,v=l?new A({apiKey:y.VITE_GEMINI_API_KEY}):null,L=()=>{const{products:x,showToast:d}=E(),[o,I]=r.useState(""),[h,g]=r.useState([]),[i,u]=r.useState(!1),[m,n]=r.useState(null),[j,f]=r.useState("L'IA rÃ©flÃ©chit...");r.useEffect(()=>{if(!i)return;const t=["Recherche d'idÃ©es pÃ©tillantes...","MÃ©lange des saveurs crÃ©atives...","Consultation des grimoires de recettes...","Finalisation des suggestions..."];let a=0;f("L'IA rÃ©flÃ©chit...");const s=setInterval(()=>{f(t[a]),a=(a+1)%t.length},2500);return()=>clearInterval(s)},[i]);const N=r.useCallback(async()=>{if(!o){d("Veuillez entrer un thÃ¨me pour la recherche d'idÃ©es.","error");return}if(!v){const s="La clÃ© API pour le service IA n'est pas configurÃ©e. Impossible de gÃ©nÃ©rer des idÃ©es.";n({message:s,type:"error"}),d(s,"error"),u(!1);return}u(!0),n(null),g([]);const t=x.map(s=>s.name).join(", "),a=`
            Je gÃ¨re la buvette d'un Ã©vÃ©nement sur le thÃ¨me de "${o}".
            J'ai dÃ©jÃ  les produits suivants : ${t||"aucun produit pour l'instant"}.
            SuggÃ¨re-moi 5 nouvelles idÃ©es de produits (boissons, snacks, confiseries) originales et adaptÃ©es Ã  ce thÃ¨me.
            Pour chaque idÃ©e, donne un nom accrocheur et une brÃ¨ve description.
        `;try{const b=(await v.models.generateContent({model:"gemini-2.5-flash",contents:a,config:{responseMimeType:"application/json",responseSchema:{type:c.ARRAY,items:{type:c.OBJECT,properties:{name:{type:c.STRING,description:"Le nom accrocheur de l'idÃ©e de produit."},description:{type:c.STRING,description:"Une brÃ¨ve description attrayante du produit."}},required:["name","description"]}}}})).text;if(!b)throw new Error("ðŸ˜… L'IA a eu un petit hoquet ! Elle n'a pas rÃ©ussi Ã  gÃ©nÃ©rer les idÃ©es attendues. Un petit rafraÃ®chissement pourrait rÃ©gler le problÃ¨me.");const p=JSON.parse(b);if(!Array.isArray(p))throw new Error("ðŸ¤– L'IA est un peu confuse et a renvoyÃ© une rÃ©ponse dans un format Ã©trange. Pouvez-vous rÃ©essayer ?");p.length===0&&n({message:"ðŸ§ L'IA a cherchÃ© partout, mais n'a trouvÃ© aucune idÃ©e pour ce thÃ¨me. Essayez d'Ãªtre plus crÃ©atif ou un peu plus prÃ©cis !",type:"info"}),g(p)}catch(s){console.error("Error generating ideas:",s),navigator.onLine?s instanceof Error&&(s.message.includes("hoquet")||s.message.includes("confuse"))?n({message:s.message,type:"error"}):n({message:"ðŸ› ï¸ Oups ! Le gÃ©nÃ©rateur d'idÃ©es rencontre un problÃ¨me technique. Veuillez patienter quelques instants avant de rÃ©essayer.",type:"error"}):n({message:"ðŸ¤” Oups, on dirait que votre connexion Internet a fait une pause. VÃ©rifiez-la et rÃ©essayez !",type:"error"}),d("Erreur lors de la gÃ©nÃ©ration d'idÃ©es.","error")}finally{u(!1)}},[o,x,d]);return e.jsxs("div",{className:"space-y-8 max-w-2xl mx-auto",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(w,{className:`w-16 h-16 mx-auto ${l?"text-amber-400":"text-slate-600"}`}),e.jsx("h1",{className:`text-4xl font-display mt-2 ${l?"text-amber-400":"text-slate-500"}`,children:"GÃ©nÃ©rateur d'IdÃ©es"}),e.jsx("p",{className:`mt-2 ${l?"text-slate-400":"text-slate-600"}`,children:"En panne d'inspiration ? Laissez l'IA vous proposer de nouveaux produits !"})]}),l?e.jsxs("div",{className:"bg-[#2a2a2a] p-6 rounded-2xl shadow-md border border-white/10 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"ThÃ¨me de l'Ã©vÃ©nement"}),e.jsx("input",{type:"text",value:o,onChange:t=>I(t.target.value),placeholder:"ex: MÃ©diÃ©val, AnnÃ©es 80, Science-Fiction...",className:"mt-1 block w-full p-2 bg-[#1a1a1a] border-white/20 text-white rounded-md shadow-sm focus:ring-amber-500 focus:border-amber-500 transition"})]}),e.jsx("button",{onClick:N,disabled:i,className:"w-full bg-amber-500 text-black font-bold py-3 rounded-full shadow-lg hover:bg-amber-600 transition-all transform hover:scale-105 font-display text-lg disabled:opacity-50 disabled:cursor-wait",children:i?"GÃ©nÃ©ration en cours...":"Trouver des idÃ©es"})]}):e.jsxs("div",{className:"bg-[#2a2a2a] p-6 rounded-2xl shadow-md border border-red-500/50 text-center",children:[e.jsx("h2",{className:"text-xl font-display text-red-300",children:"FonctionnalitÃ© Indisponible"}),e.jsx("p",{className:"text-slate-300 mt-2",children:"Le service de gÃ©nÃ©ration d'idÃ©es par IA n'est pas configurÃ©."}),e.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"(Veuillez renseigner la variable VITE_GEMINI_API_KEY dans votre environnement)."})]}),m&&e.jsx("div",{className:`text-sm p-3 rounded-lg text-center ${m.type==="error"?"bg-red-900/50 text-red-300":"bg-sky-900/50 text-sky-300"}`,children:m.message}),i&&e.jsxs("div",{className:"text-center py-8",children:[e.jsxs("svg",{className:"animate-spin h-10 w-10 text-amber-400 mx-auto",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),e.jsx("p",{className:"text-slate-400 mt-2",children:j})]}),h.length>0&&e.jsxs("div",{className:"space-y-4 animate-in fade-in-0 slide-in-from-bottom-5 duration-500",children:[e.jsxs("h2",{className:"text-2xl font-display text-slate-200 text-center",children:['RÃ©sultats pour "',o,'"']}),h.map((t,a)=>e.jsxs("div",{className:"bg-black/20 p-4 rounded-lg border-l-4 border-amber-500",children:[e.jsx("h3",{className:"font-bold text-lg text-amber-300",children:t.name}),e.jsx("p",{className:"text-slate-300",children:t.description})]},a))]})]})},S=r.memo(L);export{S as default};
