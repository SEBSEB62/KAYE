import{r as lt}from"./Icons-C56Ecv4l.js";const pt=(S,v,C,P,b,w,u,c)=>lt.useMemo(()=>{const a=t=>{if(!c)return t;const e=new Date(c.end);return e.setHours(23,59,59,999),t.filter(o=>{const n=new Date(o.date);return n>=c.start&&n<=e})},R=a(S),l=a(v),G=a(C),H=a(P),L=a(b),s=R.filter(t=>!t.refunded),g=u.initialCash||0,i=s.reduce((t,e)=>t+e.total,0),B=s.filter(t=>t.paymentMethod==="cash").reduce((t,e)=>t+e.total,0),d=s.filter(t=>t.paymentMethod==="card").reduce((t,e)=>t+e.total,0),Q=s.filter(t=>t.paymentMethod==="check").reduce((t,e)=>t+e.total,0),E=s.filter(t=>t.paymentMethod==="paypal"),z=E.reduce((t,e)=>t+e.total,0),I=s.filter(t=>t.paymentMethod==="wero").reduce((t,e)=>t+e.total,0),O=l.reduce((t,e)=>t+e.amount,0),F=l.filter(t=>t.paymentMethod==="cash"||t.paymentMethod===void 0).reduce((t,e)=>t+e.amount,0),p=l.filter(t=>t.paymentMethod==="card").reduce((t,e)=>t+e.amount,0),f=s.reduce((t,e)=>{const o=e.items.reduce((n,r)=>{const D=x.get(r.id),rt=r.purchasePrice||0,at=D?.laborTimeMinutes||0,ct=u.hourlyRate||0,ut=at/60*ct;return n+(rt+ut)*r.quantity},0);return t+o},0),J=(d+p)*.0175,K=E.reduce((t,e)=>e.total>0?t+(e.total*.029+.35):t,0),y=J+K,q=R.filter(t=>t.refunded).reduce((t,e)=>t+e.total,0),U=G.reduce((t,e)=>t+e.amount,0),m=L.reduce((t,e)=>t+e.amount,0),h=q+U,j=H.reduce((t,e)=>t+e.amount,0),A=h+j+m,V=i-f,T=B+F,W=d+p,X=g+T-A,M=i+O,Y=M-y,k=f+h+m+y,Z=M-k,_=s.reduce((t,e)=>{const o=new Date(e.date).toLocaleDateString("fr-CA");return t[o]||(t[o]=0),t[o]+=e.total,t},{}),$=Object.entries(_).map(([t,e])=>({date:t,total:Number(e)})).sort((t,e)=>new Date(t.date).getTime()-new Date(e.date).getTime()),tt=s.flatMap(t=>t.items).reduce((t,e)=>(e.isMisc||(t[e.id]=(t[e.id]||0)+e.quantity),t),{}),x=new Map(w.map(t=>[t.id,t])),N=Object.entries(tt).map(([t,e])=>{const o=x.get(t);if(!o)return null;const n=o.price*e,r=o.price-(o.purchasePrice||0),D=r*e;return{...o,unitsSold:e,revenue:n,marginPerUnit:r,totalProfit:D}}).filter(t=>t!==null),et=[...N].sort((t,e)=>e.totalProfit-t.totalProfit),ot=[...N].sort((t,e)=>e.unitsSold-t.unitsSold),st=s.flatMap(t=>t.items).reduce((t,e)=>{const o=e.category||"Divers";return t[o]||(t[o]={revenue:0,count:0}),t[o].revenue+=e.price*e.quantity,t[o].count+=e.quantity,t},{}),nt=Object.entries(st).map(([t,e])=>({name:t,...e})).sort((t,e)=>e.revenue-t.revenue);return{totalRevenue:i,totalCostOfGoods:f,grossProfit:V,totalDonations:O,cashDonations:F,cardDonations:p,totalSaleRefunds:q,totalManualRefunds:U,totalCashOuts:m,totalRemboursements:h,totalSafeDeposits:j,totalSortiesEspeces:A,totalEncaissements:M,totalCouts:k,beneficeNet:Z,cashSales:B,cardSales:d,checkSales:Q,paypalSales:z,weroSales:I,entreesEspeces:T,entreesSumUp:W,initialCash:g,caisseFinaleEspeces:X,estimatedFees:y,netRevenueAfterFees:Y,chartData:$,topProductsByProfit:et,topProductsByQuantity:ot,salesByCategory:nt,validSales:s}},[S,v,C,P,b,w,u,c]);export{pt as u};
